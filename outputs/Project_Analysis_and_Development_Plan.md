# çŸ³å¢¨å®žéªŒæ•°æ®ç®¡ç†ç³»ç»Ÿ - é¡¹ç›®ç»¼åˆåˆ†æžä¸Žå¼€å‘è§„åˆ’

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-12  
**çŠ¶æ€**: ç¼–ç é—®é¢˜å·²ä¿®å¤ï¼Œå‡†å¤‡è¿›å…¥ä¸‹ä¸€é˜¶æ®µ  

---

## ðŸ“Š ä¸€ã€é¡¹ç›®å½“å‰çŠ¶æ€æ€»è§ˆ

### 1.1 å·²å®ŒæˆåŠŸèƒ½ âœ…

#### **Phase 1-3: åŸºç¡€æž¶æž„ (100%å®Œæˆ)**
- âœ… å‰ç«¯æ¡†æž¶æ­å»º (Vue 3 + TypeScript + Element Plus)
- âœ… åŽç«¯æ¡†æž¶æ­å»º (Flask + SQLAlchemy + MySQL)
- âœ… æ•°æ®åº“è®¾è®¡å®Œæˆ (15å¼ è¡¨ï¼Œ99ä¸ªå­—æ®µ)
- âœ… JWTè®¤è¯ç³»ç»Ÿå®Œæ•´å®žçŽ°
- âœ… ç”¨æˆ·ç™»å½•/ç™»å‡ºåŠŸèƒ½æ­£å¸¸

#### **Phase 4A: è¡¨å•UIå¼€å‘ (100%å®Œæˆ)**
- âœ… CreateExperiment.vue å®Œæ•´å®žçŽ° (7ä¸ªTabé¡µ)
- âœ… 9ä¸ªæœç´¢ä¸‹æ‹‰æ¡†åŠŸèƒ½æ­£å¸¸
- âœ… è¡¨å•éªŒè¯è§„åˆ™å®Œæ•´
- âœ… å®žéªŒç¼–ç è‡ªåŠ¨ç”Ÿæˆé€»è¾‘å·²ä¿®å¤

#### **Phase 4B: è‰ç¨¿ä¿å­˜åŠŸèƒ½ (100%å®Œæˆ)** 
- âœ… POST /api/experiments/draft - è‰ç¨¿ä¿å­˜API
- âœ… PUT /api/experiments/{id}/draft - è‰ç¨¿æ›´æ–°API
- âœ… å‰ç«¯è‰ç¨¿ä¿å­˜é€»è¾‘å®Œå–„
- âœ… å®žéªŒç¼–ç æ ¼å¼é—®é¢˜å·²ä¿®å¤ï¼ˆ3ä¸ªè¿žå­—ç¬¦ï¼‰
- âœ… JWT Tokenè®¤è¯æ­£å¸¸å·¥ä½œ

---

### 1.2 å·²çŸ¥ä½†å¯æŽ¥å—çš„é—®é¢˜ âš ï¸

1. **æœç´¢API CORSé”™è¯¯** (ä¸å½±å“ä½¿ç”¨)
   - çŽ°è±¡ï¼šæœç´¢APIè¿”å›žCORSé”™è¯¯
   - å½±å“ï¼šä¼šè‡ªåŠ¨fallbackåˆ°æœ¬åœ°è¿‡æ»¤
   - ä¼˜å…ˆçº§ï¼šä½Ž (å¯å»¶åŽå¤„ç†)

2. **pi_thickness_detailå­—æ®µæ— æ•°æ®** (æ•°æ®åº“é—®é¢˜)
   - çŽ°è±¡ï¼šæ•°æ®åº“ä¸­ç¡®å®žæ²¡æœ‰è¿™ä¸ªå­—æ®µçš„æ•°æ®
   - å½±å“ï¼šå­—æ®µæ˜¾ç¤ºä¸ºç©º
   - ä¼˜å…ˆçº§ï¼šä½Ž (å¯å»¶åŽå¡«å……)

---

### 1.3 å¾…å¼€å‘åŠŸèƒ½ ðŸš§

#### **ä¼˜å…ˆçº§ P0 - ç«‹å³å¼€å§‹ (1-2å¤©)**
- â³ **æ­£å¼æäº¤åŠŸèƒ½** - POST /api/experiments
  - éªŒè¯æ‰€æœ‰40ä¸ªå¿…å¡«å­—æ®µ
  - çŠ¶æ€å˜æ›´ä¸º 'submitted'
  - æäº¤æˆåŠŸåŽè·³è½¬åˆ°æ•°æ®åº“é¡µé¢

#### **ä¼˜å…ˆçº§ P1 - æœ¬å‘¨å®Œæˆ (2-3å¤©)**
- â³ **å®žéªŒæ•°æ®ç®¡ç†é¡µé¢** - ExperimentDatabase.vue
  - å®žéªŒåˆ—è¡¨æŸ¥è¯¢ (åˆ†é¡µã€æœç´¢ã€ç­›é€‰)
  - å®žéªŒè¯¦æƒ…æŸ¥çœ‹
  - å®žéªŒæ•°æ®ç¼–è¾‘ (å¤ç”¨CreateExperiment.vue)
  - å®žéªŒæ•°æ®åˆ é™¤ (æƒé™æŽ§åˆ¶)
  - æ•°æ®å¯¼å‡º (CSVæ ¼å¼)

#### **ä¼˜å…ˆçº§ P2 - ä¸‹å‘¨å®Œæˆ (2-3å¤©)**
- â³ **æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½** (9ä¸ªå­—æ®µ)
  - æµ‹è¯•å·²æœ‰ FileUpload.vue ç»„ä»¶
  - é›†æˆæ–‡ä»¶ä¸Šä¼ åˆ°å®žéªŒæäº¤æµç¨‹
  - æ–‡ä»¶é¢„è§ˆå’Œä¸‹è½½åŠŸèƒ½

#### **ä¼˜å…ˆçº§ P3 - å¯å»¶åŽ (1-2å¤©)**
- â³ **æœç´¢ä¸‹æ‹‰ä¼˜åŒ–**
  - ä¿®å¤CORSé—®é¢˜
  - å®žçŽ°"æ·»åŠ æ–°å€¼"åŠŸèƒ½
  - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

---

## ðŸŽ¯ äºŒã€å…³é”®å†³ç­–ï¼šä¸‹ä¸€æ­¥åšä»€ä¹ˆï¼Ÿ

### 2.1 é—®é¢˜åˆ†æž

æ‚¨æåˆ°çš„ä¸¤ä¸ªæ–¹å‘ï¼š
1. **Phase 4B (ç»§ç»­)**: å®žéªŒæ•°æ®æäº¤APIã€æ–‡ä»¶ä¸Šä¼ ã€æ•°æ®éªŒè¯
2. **Phase 4C (å¼€å§‹)**: æ•°æ®ç®¡ç†åŠŸèƒ½ã€åˆ—è¡¨æŸ¥è¯¢ã€ç¼–è¾‘åˆ é™¤ã€å¯¼å‡º

**æ ¸å¿ƒçŸ›ç›¾**ï¼š
- å‰ç«¯è¡¨å•UIå·²å®Œæˆï¼Œä½†**åªèƒ½ä¿å­˜è‰ç¨¿ï¼Œæ— æ³•æ­£å¼æäº¤**
- è‰ç¨¿ä¿å­˜åŽï¼Œç”¨æˆ·**æ— æ³•æŸ¥çœ‹å·²ä¿å­˜çš„æ•°æ®**
- ç³»ç»Ÿ**ç¼ºå°‘å®Œæ•´çš„æ•°æ®é—­çŽ¯**

---

### 2.2 æŽ¨èæ–¹æ¡ˆï¼š**æ··åˆå¼€å‘ç­–ç•¥** â­â­â­

#### **é˜¶æ®µ1ï¼šå®Œæˆæ ¸å¿ƒæ•°æ®æµ (2-3å¤©ï¼Œæœ€é«˜ä¼˜å…ˆçº§)**

**ä¸ºä»€ä¹ˆè¿™æ ·å®‰æŽ’ï¼Ÿ**
- ç”¨æˆ·å·²ç»èƒ½åˆ›å»ºå®žéªŒã€ä¿å­˜è‰ç¨¿
- ä½†æ— æ³•æ­£å¼æäº¤ã€æ— æ³•æŸ¥çœ‹å·²ä¿å­˜çš„å†…å®¹
- è¿™æ˜¯**æ•°æ®é—­çŽ¯çš„æœ€åŽä¸€å…¬é‡Œ**

**å…·ä½“ä»»åŠ¡**ï¼š

##### **ä»»åŠ¡Aï¼šå®žéªŒæ­£å¼æäº¤åŠŸèƒ½ (ä¼˜å…ˆçº§ P0)** - 1å¤©
```
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¤Ÿå®Œæˆå®žéªŒæ•°æ®çš„æ­£å¼æäº¤

åŽç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ å®Œå–„ POST /api/experiments API
âœ“ å®žçŽ°40ä¸ªå¿…å¡«å­—æ®µéªŒè¯
âœ“ çŠ¶æ€å˜æ›´ä¸º 'submitted'
âœ“ è®°å½• submitted_at æ—¶é—´

å‰ç«¯å¼€å‘ (2å°æ—¶)ï¼š
âœ“ å®Œå–„ handleSubmit() å‡½æ•°
âœ“ æ·»åŠ æäº¤å‰äºŒæ¬¡ç¡®è®¤
âœ“ æ·»åŠ æäº¤æˆåŠŸåŽçš„è·³è½¬é€»è¾‘
âœ“ ä¼˜åŒ–é”™è¯¯æç¤º

æµ‹è¯•éªŒè¯ (2å°æ—¶)ï¼š
âœ“ æµ‹è¯•å¿…å¡«å­—æ®µéªŒè¯
âœ“ æµ‹è¯•æäº¤æˆåŠŸæµç¨‹
âœ“ æµ‹è¯•æƒé™æŽ§åˆ¶
âœ“ æµ‹è¯•é”™è¯¯å¤„ç†
```

##### **ä»»åŠ¡Bï¼šå®žéªŒåˆ—è¡¨æŸ¥è¯¢é¡µé¢ (ä¼˜å…ˆçº§ P1)** - 1.5å¤©
```
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¤ŸæŸ¥çœ‹å·²ä¿å­˜/æäº¤çš„å®žéªŒ

åŽç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ GET /api/experiments - åˆ—è¡¨æŸ¥è¯¢API
âœ“ æ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰
âœ“ æ”¯æŒçŠ¶æ€ç­›é€‰ (draft/submitted)
âœ“ æƒé™æŽ§åˆ¶ (ç”¨æˆ·åªèƒ½çœ‹è‡ªå·±çš„)

å‰ç«¯å¼€å‘ (8å°æ—¶)ï¼š
âœ“ åˆ›å»º ExperimentDatabase.vue é¡µé¢
âœ“ å®žçŽ°æ•°æ®è¡¨æ ¼å±•ç¤º
âœ“ å®žçŽ°æœç´¢å’Œç­›é€‰åŠŸèƒ½
âœ“ å®žçŽ°åˆ†é¡µåŠŸèƒ½
âœ“ å®žçŽ°æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®

æµ‹è¯•éªŒè¯ (2å°æ—¶)ï¼š
âœ“ æµ‹è¯•åˆ—è¡¨åŠ è½½
âœ“ æµ‹è¯•æœç´¢åŠŸèƒ½
âœ“ æµ‹è¯•ç­›é€‰åŠŸèƒ½
âœ“ æµ‹è¯•åˆ†é¡µåŠŸèƒ½
```

##### **ä»»åŠ¡Cï¼šå®žéªŒè¯¦æƒ…æŸ¥çœ‹é¡µé¢ (ä¼˜å…ˆçº§ P1)** - 0.5å¤©
```
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¤ŸæŸ¥çœ‹å®žéªŒçš„å®Œæ•´æ•°æ®

å‰ç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ åˆ›å»º ExperimentDetail.vue é¡µé¢
âœ“ æ˜¾ç¤º7ä¸ªæ¨¡å—çš„å®Œæ•´æ•°æ®
âœ“ æ·»åŠ æ‰“å°åŠŸèƒ½
âœ“ æ·»åŠ è¿”å›žåˆ—è¡¨æŒ‰é’®

åŽç«¯æ— éœ€å¼€å‘ï¼š
- å·²æœ‰ GET /api/experiments/{id} API

æµ‹è¯•éªŒè¯ (1å°æ—¶)ï¼š
âœ“ æµ‹è¯•è¯¦æƒ…é¡µé¢å±•ç¤º
âœ“ æµ‹è¯•æ‰“å°åŠŸèƒ½
```

**å®ŒæˆåŽçš„æ•ˆæžœ**ï¼š
- âœ… ç”¨æˆ·èƒ½åˆ›å»ºå®žéªŒ â†’ ä¿å­˜è‰ç¨¿ â†’ æ­£å¼æäº¤
- âœ… ç”¨æˆ·èƒ½æŸ¥çœ‹æ‰€æœ‰å®žéªŒ â†’ æŸ¥çœ‹è¯¦æƒ… â†’ æ‰“å°æŠ¥å‘Š
- âœ… å®Œæ•´çš„æ•°æ®é—­çŽ¯å½¢æˆ

---

#### **é˜¶æ®µ2ï¼šå®Œå–„æ•°æ®ç®¡ç†åŠŸèƒ½ (2-3å¤©)**

##### **ä»»åŠ¡Dï¼šç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½ (ä¼˜å…ˆçº§ P1)** - 1.5å¤©
```
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¤Ÿä¿®æ”¹å’Œåˆ é™¤å®žéªŒæ•°æ®

åŽç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ PUT /api/experiments/{id} - æ›´æ–°å®žéªŒ
âœ“ DELETE /api/experiments/{id} - åˆ é™¤å®žéªŒ
âœ“ æƒé™æŽ§åˆ¶ (åªèƒ½åˆ é™¤è‰ç¨¿)
âœ“ æƒé™æŽ§åˆ¶ (åªèƒ½åˆ é™¤è‡ªå·±çš„)

å‰ç«¯å¼€å‘ (8å°æ—¶)ï¼š
âœ“ å®žçŽ°ç¼–è¾‘æŒ‰é’® (å¤ç”¨CreateExperiment.vue)
âœ“ åŠ è½½å·²æœ‰æ•°æ®åˆ°è¡¨å•
âœ“ å®žçŽ°åˆ é™¤æŒ‰é’® (äºŒæ¬¡ç¡®è®¤)
âœ“ æ›´æ–°åˆ—è¡¨é¡µé¢çš„æŒ‰é’®çŠ¶æ€

æµ‹è¯•éªŒè¯ (2å°æ—¶)ï¼š
âœ“ æµ‹è¯•ç¼–è¾‘åŠŸèƒ½
âœ“ æµ‹è¯•åˆ é™¤åŠŸèƒ½
âœ“ æµ‹è¯•æƒé™æŽ§åˆ¶
```

##### **ä»»åŠ¡Eï¼šæ•°æ®å¯¼å‡ºåŠŸèƒ½ (ä¼˜å…ˆçº§ P1)** - 0.5å¤©
```
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¤Ÿå¯¼å‡ºå®žéªŒæ•°æ®

åŽç«¯å¼€å‘ (3å°æ—¶)ï¼š
âœ“ POST /api/experiments/export - å¯¼å‡ºCSV
âœ“ æ”¯æŒæ‰¹é‡å¯¼å‡º
âœ“ æ”¯æŒç­›é€‰æ¡ä»¶

å‰ç«¯å¼€å‘ (1å°æ—¶)ï¼š
âœ“ æ·»åŠ å¯¼å‡ºæŒ‰é’®
âœ“ å®žçŽ°æ–‡ä»¶ä¸‹è½½

æµ‹è¯•éªŒè¯ (1å°æ—¶)ï¼š
âœ“ æµ‹è¯•å¯¼å‡ºåŠŸèƒ½
âœ“ æµ‹è¯•CSVæ ¼å¼
```

---

#### **é˜¶æ®µ3ï¼šæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ (2-3å¤©)**

##### **ä»»åŠ¡Fï¼šæ–‡ä»¶ä¸Šä¼ é›†æˆ (ä¼˜å…ˆçº§ P2)** - 2å¤©
```
ç›®æ ‡ï¼šè®©9ä¸ªæ–‡ä»¶ä¸Šä¼ å­—æ®µèƒ½å¤Ÿæ­£å¸¸å·¥ä½œ

åŽç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ æµ‹è¯•å·²æœ‰ POST /api/files/upload API
âœ“ å®žçŽ°æ–‡ä»¶å­˜å‚¨é€»è¾‘
âœ“ å®žçŽ°æ–‡ä»¶åŽ‹ç¼©åŠŸèƒ½
âœ“ å®žçŽ°æ–‡ä»¶å¤§å°é™åˆ¶

å‰ç«¯å¼€å‘ (10å°æ—¶)ï¼š
âœ“ æµ‹è¯• FileUpload.vue ç»„ä»¶
âœ“ é›†æˆæ–‡ä»¶ä¸Šä¼ åˆ°å®žéªŒè¡¨å•
âœ“ å®žçŽ°æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
âœ“ å®žçŽ°æ–‡ä»¶åˆ é™¤åŠŸèƒ½

æµ‹è¯•éªŒè¯ (2å°æ—¶)ï¼š
âœ“ æµ‹è¯•9ä¸ªæ–‡ä»¶å­—æ®µ
âœ“ æµ‹è¯•æ–‡ä»¶ä¸Šä¼ 
âœ“ æµ‹è¯•æ–‡ä»¶é¢„è§ˆ
âœ“ æµ‹è¯•æ–‡ä»¶åˆ é™¤
```

---

#### **é˜¶æ®µ4ï¼šä¼˜åŒ–å’Œå®Œå–„ (1-2å¤©)**

##### **ä»»åŠ¡Gï¼šæœç´¢ä¸‹æ‹‰ä¼˜åŒ– (ä¼˜å…ˆçº§ P3)** - 1å¤©
```
ç›®æ ‡ï¼šä¼˜åŒ–æœç´¢ä¸‹æ‹‰ç»„ä»¶çš„ç”¨æˆ·ä½“éªŒ

åŽç«¯å¼€å‘ (2å°æ—¶)ï¼š
âœ“ ä¿®å¤CORSé—®é¢˜
âœ“ å®žçŽ°"æ·»åŠ æ–°å€¼"API

å‰ç«¯å¼€å‘ (4å°æ—¶)ï¼š
âœ“ é‡æž„ SearchableSelect.vue
âœ“ å®žçŽ°"æ·»åŠ æ–°å€¼"åŠŸèƒ½
âœ“ ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

æµ‹è¯•éªŒè¯ (1å°æ—¶)ï¼š
âœ“ æµ‹è¯•æœç´¢åŠŸèƒ½
âœ“ æµ‹è¯•æ·»åŠ æ–°å€¼
```

---

## ðŸ“… ä¸‰ã€è¯¦ç»†å¼€å‘è®¡åˆ’

### ç¬¬1å‘¨ï¼šæ ¸å¿ƒåŠŸèƒ½å®Œæˆ (5ä¸ªå·¥ä½œæ—¥)

#### **Day 1-2ï¼šå®žéªŒæäº¤ + åˆ—è¡¨æŸ¥è¯¢**
- ä¸Šåˆï¼šå¼€å‘å®žéªŒæ­£å¼æäº¤API
- ä¸‹åˆï¼šå¼€å‘å®žéªŒåˆ—è¡¨æŸ¥è¯¢API
- æ™šä¸Šï¼šå¼€å‘ExperimentDatabase.vueé¡µé¢

#### **Day 3ï¼šå®žéªŒè¯¦æƒ… + ç¼–è¾‘åˆ é™¤**
- ä¸Šåˆï¼šå¼€å‘ExperimentDetail.vueé¡µé¢
- ä¸‹åˆï¼šå¼€å‘ç¼–è¾‘å’Œåˆ é™¤API
- æ™šä¸Šï¼šé›†æˆç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½

#### **Day 4ï¼šæ•°æ®å¯¼å‡º + æµ‹è¯•**
- ä¸Šåˆï¼šå¼€å‘æ•°æ®å¯¼å‡ºåŠŸèƒ½
- ä¸‹åˆï¼šç³»ç»ŸåŠŸèƒ½æµ‹è¯•
- æ™šä¸Šï¼šä¿®å¤å‘çŽ°çš„é—®é¢˜

#### **Day 5ï¼šæ–‡ä»¶ä¸Šä¼ é›†æˆ**
- ä¸Šåˆï¼šæµ‹è¯•FileUpload.vueç»„ä»¶
- ä¸‹åˆï¼šé›†æˆæ–‡ä»¶ä¸Šä¼ åˆ°è¡¨å•
- æ™šä¸Šï¼šæµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

---

### ç¬¬2å‘¨ï¼šä¼˜åŒ–å’Œå®Œå–„ (5ä¸ªå·¥ä½œæ—¥)

#### **Day 6-7ï¼šæ–‡ä»¶ä¸Šä¼ å®Œå–„**
- æ–‡ä»¶é¢„è§ˆåŠŸèƒ½
- æ–‡ä»¶ä¸‹è½½åŠŸèƒ½
- æ–‡ä»¶å¤§å°é™åˆ¶
- æ–‡ä»¶ç±»åž‹éªŒè¯

#### **Day 8ï¼šæœç´¢ä¸‹æ‹‰ä¼˜åŒ–**
- ä¿®å¤CORSé—®é¢˜
- å®žçŽ°"æ·»åŠ æ–°å€¼"åŠŸèƒ½
- ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

#### **Day 9-10ï¼šç³»ç»Ÿæµ‹è¯•å’Œä¼˜åŒ–**
- åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–
- ç”¨æˆ·ä½“éªŒè°ƒä¼˜
- æ–‡æ¡£æ›´æ–°

---

## ðŸ”‘ å››ã€å…³é”®æŠ€æœ¯è¦ç‚¹

### 4.1 å®žéªŒæäº¤APIè®¾è®¡

```python
@experiments_bp.route('', methods=['POST'])
def create_experiment():
    """
    æ­£å¼æäº¤å®žéªŒ - éªŒè¯æ‰€æœ‰å¿…å¡«å­—æ®µ
    
    å¿…å¡«å­—æ®µ (40ä¸ª)ï¼š
    - åŸºæœ¬å‚æ•° (10ä¸ª)
    - PIè†œå‚æ•° (4ä¸ª)
    - ç¢³åŒ–å‚æ•° (7ä¸ª)
    - çŸ³å¢¨åŒ–å‚æ•° (9ä¸ª)
    - æˆå“å‚æ•° (10ä¸ª)
    """
    
    # 1. JWTéªŒè¯
    verify_jwt_in_request()
    current_user_id = int(get_jwt_identity())
    
    # 2. èŽ·å–æ•°æ®
    data = request.get_json()
    experiment_code = data.get('experiment_code')
    
    # 3. éªŒè¯å®žéªŒç¼–ç æ ¼å¼
    is_valid, error_msg = validate_experiment_code_format(experiment_code)
    if not is_valid:
        return jsonify({'error': error_msg}), 400
    
    # 4. éªŒè¯å®žéªŒç¼–ç å”¯ä¸€æ€§
    existing = Experiment.query.filter_by(experiment_code=experiment_code).first()
    if existing:
        return jsonify({'error': f'å®žéªŒç¼–ç  {experiment_code} å·²å­˜åœ¨'}), 400
    
    # 5. éªŒè¯æ‰€æœ‰å¿…å¡«å­—æ®µ
    required_fields = get_required_fields_for_submission()
    missing_fields = []
    
    for field in required_fields:
        value = data.get(field)
        if value is None or value == '' or value == []:
            missing_fields.append(field)
    
    if missing_fields:
        return jsonify({
            'error': 'ç¼ºå°‘å¿…å¡«å­—æ®µ',
            'missing_fields': missing_fields
        }), 400
    
    # 6. åˆ›å»ºå®žéªŒè®°å½•
    experiment = Experiment(
        experiment_code=experiment_code,
        creator_id=current_user_id,
        status='submitted',  # â† å…³é”®ï¼šçŠ¶æ€ä¸ºsubmitted
        submitted_at=datetime.now()  # â† å…³é”®ï¼šè®°å½•æäº¤æ—¶é—´
    )
    db.session.add(experiment)
    db.session.flush()
    
    # 7. ä¿å­˜æ‰€æœ‰æ¨¡å—æ•°æ®
    _save_basic_params(experiment.id, data)
    _save_pi_params(experiment.id, data)
    _save_loose_params(experiment.id, data)
    _save_carbon_params(experiment.id, data)
    _save_graphite_params(experiment.id, data)
    _save_rolling_params(experiment.id, data)
    _save_product_params(experiment.id, data)
    
    db.session.commit()
    
    return jsonify({
        'message': 'å®žéªŒæäº¤æˆåŠŸ',
        'id': experiment.id,
        'experiment_code': experiment_code
    }), 201
```

---

### 4.2 å®žéªŒåˆ—è¡¨æŸ¥è¯¢APIè®¾è®¡

```python
@experiments_bp.route('', methods=['GET'])
def get_experiments():
    """
    èŽ·å–å®žéªŒåˆ—è¡¨ - æ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰
    
    æŸ¥è¯¢å‚æ•°ï¼š
    - page: é¡µç  (é»˜è®¤1)
    - per_page: æ¯é¡µæ•°é‡ (é»˜è®¤20)
    - status: çŠ¶æ€ç­›é€‰ (draft/submitted)
    - search: æœç´¢å…³é”®è¯ (å®žéªŒç¼–ç ã€å®¢æˆ·åç§°)
    - customer_name: å®¢æˆ·åç§°ç­›é€‰
    - date_from: å¼€å§‹æ—¥æœŸ
    - date_to: ç»“æŸæ—¥æœŸ
    """
    
    # 1. JWTéªŒè¯
    verify_jwt_in_request()
    current_user_id = int(get_jwt_identity())
    current_user = User.query.get(current_user_id)
    
    # 2. èŽ·å–æŸ¥è¯¢å‚æ•°
    page = request.args.get('page', 1, type=int)
    per_page = request.args.get('per_page', 20, type=int)
    status = request.args.get('status', None)
    search = request.args.get('search', None)
    customer_name = request.args.get('customer_name', None)
    date_from = request.args.get('date_from', None)
    date_to = request.args.get('date_to', None)
    
    # 3. æž„å»ºæŸ¥è¯¢
    query = Experiment.query
    
    # æƒé™æŽ§åˆ¶ï¼šæ™®é€šç”¨æˆ·åªèƒ½çœ‹è‡ªå·±çš„æ•°æ®
    if current_user.role == 'user':
        query = query.filter_by(creator_id=current_user_id)
    
    # çŠ¶æ€ç­›é€‰
    if status:
        query = query.filter_by(status=status)
    
    # æœç´¢å…³é”®è¯
    if search:
        query = query.join(ExperimentBasic).filter(
            db.or_(
                Experiment.experiment_code.like(f'%{search}%'),
                ExperimentBasic.customer_name.like(f'%{search}%')
            )
        )
    
    # å®¢æˆ·åç§°ç­›é€‰
    if customer_name:
        query = query.join(ExperimentBasic).filter(
            ExperimentBasic.customer_name == customer_name
        )
    
    # æ—¥æœŸç­›é€‰
    if date_from:
        query = query.join(ExperimentBasic).filter(
            ExperimentBasic.experiment_date >= date_from
        )
    if date_to:
        query = query.join(ExperimentBasic).filter(
            ExperimentBasic.experiment_date <= date_to
        )
    
    # 4. åˆ†é¡µæŸ¥è¯¢
    pagination = query.order_by(Experiment.created_at.desc()).paginate(
        page=page,
        per_page=per_page,
        error_out=False
    )
    
    # 5. æ ¼å¼åŒ–å“åº”
    experiments = []
    for exp in pagination.items:
        basic = ExperimentBasic.query.filter_by(experiment_id=exp.id).first()
        experiments.append({
            'id': exp.id,
            'experiment_code': exp.experiment_code,
            'customer_name': basic.customer_name if basic else None,
            'experiment_date': basic.experiment_date if basic else None,
            'status': exp.status,
            'created_at': exp.created_at.isoformat(),
            'creator_name': exp.creator.real_name if exp.creator else None
        })
    
    return jsonify({
        'experiments': experiments,
        'total': pagination.total,
        'page': page,
        'per_page': per_page,
        'pages': pagination.pages
    }), 200
```

---

### 4.3 å‰ç«¯è¡¨å•æäº¤é€»è¾‘

```typescript
async function handleSubmit() {
  if (!formRef.value) return

  // 1. æ£€æŸ¥å®žéªŒç¼–ç 
  if (!experimentCode.value) {
    ElMessage.error('å®žéªŒç¼–ç æœªç”Ÿæˆï¼Œè¯·æ£€æŸ¥åŸºæœ¬å‚æ•°æ˜¯å¦å¡«å†™å®Œæ•´')
    activeTab.value = 'basic'
    return
  }

  loading.submit = true

  try {
    // 2. éªŒè¯æ‰€æœ‰å¿…å¡«å­—æ®µ
    await formRef.value.validate()

    // 3. ç¡®è®¤æäº¤å¯¹è¯æ¡†
    await ElMessageBox.confirm(
      'ç¡®è®¤æäº¤å®žéªŒæ•°æ®å—ï¼Ÿæäº¤åŽå°†æ— æ³•ä¿®æ”¹ã€‚',
      'ç¡®è®¤æäº¤',
      {
        confirmButtonText: 'ç¡®è®¤æäº¤',
        cancelButtonText: 'å–æ¶ˆ',
        type: 'warning',
        distinguishCancelAndClose: true
      }
    )

    // 4. å‡†å¤‡æäº¤æ•°æ®
    const submitData = prepareSubmitData()

    // 5. è°ƒç”¨APIæäº¤å®žéªŒ
    const response = await experimentApi.submitExperiment(submitData)

    // 6. æäº¤æˆåŠŸæç¤º
    ElMessage.success({
      message: `å®žéªŒæäº¤æˆåŠŸï¼å®žéªŒç¼–ç ï¼š${response.experiment_code}`,
      duration: 3000
    })

    // 7. è·³è½¬åˆ°æ•°æ®åº“é¡µé¢
    router.push({
      name: 'ExperimentDatabase',
      query: { highlight: response.id }
    })

  } catch (error: any) {
    if (error !== 'cancel') {
      console.error('æäº¤å®žéªŒå¤±è´¥:', error)
      
      // æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
      if (error.response?.data?.missing_fields) {
        const fields = error.response.data.missing_fields
        ElMessage.error({
          message: `ç¼ºå°‘å¿…å¡«å­—æ®µï¼š${fields.join(', ')}`,
          duration: 5000
        })
      } else {
        ElMessage.error(error.message || 'æäº¤å¤±è´¥')
      }
    }
  } finally {
    loading.submit = false
  }
}
```

---

## ðŸš€ äº”ã€ç«‹å³è¡ŒåŠ¨è®¡åˆ’

### ä»Šå¤©ä¸‹åˆ (2-3å°æ—¶)

1. **å¼€å‘å®žéªŒæ­£å¼æäº¤API**
   ```bash
   # ç¼–è¾‘æ–‡ä»¶
   graphite-backend/app/routes/experiments.py
   
   # å®Œå–„ create_experiment() å‡½æ•°
   # å®žçŽ°40ä¸ªå¿…å¡«å­—æ®µéªŒè¯
   # å®žçŽ°çŠ¶æ€å˜æ›´ä¸º 'submitted'
   ```

2. **æµ‹è¯•æäº¤åŠŸèƒ½**
   ```bash
   # å¯åŠ¨åŽç«¯
   cd graphite-backend
   python run.py
   
   # å¯åŠ¨å‰ç«¯
   cd graphite-frontend
   npm run dev
   
   # æµ‹è¯•æäº¤æµç¨‹
   ```

---

### æ˜Žå¤©ä¸Šåˆ (3-4å°æ—¶)

1. **å¼€å‘å®žéªŒåˆ—è¡¨æŸ¥è¯¢API**
   ```bash
   # ç¼–è¾‘æ–‡ä»¶
   graphite-backend/app/routes/experiments.py
   
   # å®žçŽ° get_experiments() å‡½æ•°
   # æ”¯æŒåˆ†é¡µã€æœç´¢ã€ç­›é€‰
   ```

2. **åˆ›å»ºExperimentDatabase.vueé¡µé¢**
   ```bash
   # åˆ›å»ºæ–‡ä»¶
   graphite-frontend/src/views/experiments/ExperimentDatabase.vue
   
   # å®žçŽ°æ•°æ®è¡¨æ ¼å±•ç¤º
   # å®žçŽ°æœç´¢å’Œç­›é€‰åŠŸèƒ½
   ```

---

### æ˜Žå¤©ä¸‹åˆ (3-4å°æ—¶)

1. **åˆ›å»ºExperimentDetail.vueé¡µé¢**
   ```bash
   # åˆ›å»ºæ–‡ä»¶
   graphite-frontend/src/views/experiments/ExperimentDetail.vue
   
   # æ˜¾ç¤º7ä¸ªæ¨¡å—çš„å®Œæ•´æ•°æ®
   ```

2. **é…ç½®è·¯ç”±**
   ```bash
   # ç¼–è¾‘æ–‡ä»¶
   graphite-frontend/src/router/index.ts
   
   # æ·»åŠ è·¯ç”±é…ç½®
   ```

---

## ðŸ“ å…­ã€æ€»ç»“å’Œå»ºè®®

### 6.1 ä¸ºä»€ä¹ˆæŽ¨èè¿™ä¸ªæ–¹æ¡ˆï¼Ÿ

1. **å¿«é€Ÿå½¢æˆæ•°æ®é—­çŽ¯** (2-3å¤©)
   - ç”¨æˆ·èƒ½å®Œæ•´ä½“éªŒï¼šåˆ›å»º â†’ ä¿å­˜ â†’ æäº¤ â†’ æŸ¥çœ‹
   - ç³»ç»Ÿå…·å¤‡æ ¸å¿ƒä»·å€¼

2. **æ¸è¿›å¼å¼€å‘**
   - æ¯ä¸ªé˜¶æ®µéƒ½èƒ½äº¤ä»˜å¯ç”¨åŠŸèƒ½
   - é™ä½Žå¼€å‘é£Žé™©
   - ä¾¿äºŽæµ‹è¯•å’Œè°ƒè¯•

3. **ä¼˜å…ˆçº§æ˜Žç¡®**
   - P0: æ ¸å¿ƒæ•°æ®æµ (å¿…é¡»)
   - P1: æ•°æ®ç®¡ç† (é‡è¦)
   - P2: æ–‡ä»¶ä¸Šä¼  (è¡¥å……)
   - P3: ä¼˜åŒ–å®Œå–„ (é”¦ä¸Šæ·»èŠ±)

---

### 6.2 å…³é”®æˆåŠŸå› ç´ 

1. **ä¿æŒä¸“æ³¨**
   - ä¸è¦è¢«æ¬¡è¦åŠŸèƒ½åˆ†æ•£ç²¾åŠ›
   - å…ˆå®Œæˆæ ¸å¿ƒæµç¨‹

2. **å¿«é€Ÿè¿­ä»£**
   - æ¯å¤©éƒ½æœ‰å¯å±•ç¤ºçš„è¿›å±•
   - åŠæ—¶å‘çŽ°å’Œè§£å†³é—®é¢˜

3. **å……åˆ†æµ‹è¯•**
   - æ¯ä¸ªåŠŸèƒ½å¼€å‘å®Œç«‹å³æµ‹è¯•
   - ä¸è¦ç§¯ç´¯æŠ€æœ¯å€ºåŠ¡

---

### 6.3 é£Žé™©æç¤º

1. **æ—¶é—´ä¼°ç®—**
   - å®žé™…å¼€å‘å¯èƒ½éœ€è¦æ›´å¤šæ—¶é—´
   - é¢„ç•™ç¼“å†²æ—¶é—´

2. **ä¾èµ–é—®é¢˜**
   - æ³¨æ„å‰åŽç«¯æŽ¥å£å¯¹æŽ¥
   - åŠæ—¶æ²Ÿé€šå’Œè°ƒè¯•

3. **ç”¨æˆ·ä½“éªŒ**
   - ä¸è¦å¿½è§†ç»†èŠ‚
   - é”™è¯¯æç¤ºè¦å‹å¥½

---

## ðŸŽ¯ ä¸ƒã€ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¼€å§‹ (çŽ°åœ¨)

1. **é˜…è¯»é¡¹ç›®çŸ¥è¯†åº“ä¸­çš„APIæ–‡æ¡£**
   - docs/API_Documentation.md
   - docs/Frontend_Components_Documentation.md

2. **åˆ›å»ºå·¥ä½œåˆ†æ”¯**
   ```bash
   git checkout -b feature/experiment-submission
   ```

3. **å¼€å§‹å¼€å‘å®žéªŒæäº¤API**
   - ç¼–è¾‘ graphite-backend/app/routes/experiments.py
   - å®žçŽ° create_experiment() å‡½æ•°
   - æ·»åŠ 40ä¸ªå¿…å¡«å­—æ®µéªŒè¯

---

### éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥é˜…é¡¹ç›®çŸ¥è¯†åº“ä¸­çš„æ–‡æ¡£
2. æŸ¥çœ‹ä¹‹å‰çš„èŠå¤©è®°å½•
3. ä½¿ç”¨æµè§ˆå™¨æŽ§åˆ¶å°è°ƒè¯•
4. æŸ¥çœ‹åŽç«¯Flaskæ—¥å¿—

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ðŸš€

---

**æ–‡æ¡£ç»“æŸ**
